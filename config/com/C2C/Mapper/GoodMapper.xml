<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.C2C.Mapper.GoodMapper">

  <select id="getGoodByIdGoods" resultMap="goodAndMessage">
  	SELECT * FROM c2cdemo.goods where idGoods = #{idGoods}
  </select>
  
  <resultMap type="com.C2C.Entity.Good" id="goodAndMessage" autoMapping="true">
  	<association property="leaveMessages" select="com.C2C.Mapper.GoodLeaveMessageMapper.getGoodLeaveMessageByGoodId" column="idGoods"></association>
  </resultMap>
  
  <select id="getGoodsByPositionAndPage" resultMap="goodsByPositionAndPage">
  	SELECT 
	goods.idGoods,
	goods.goodPhoto,
	goods.goodName,
	goods.price,
	store.storeOwner
	FROM goods,store
	where store.position = (
		select idposition from position where position.positionName like #{positionName} and position.range like #{range} limit 0,1
	) 
	and goods.sellStore = store.idStore
	order by idGoods
	limit #{page},25
  </select>
  
  <resultMap type="com.C2C.Entity.Good" id="goodsByPositionAndPage" autoMapping="true">
  	<association property="owner" javaType="com.C2C.Entity.Store">
  		<result property="idStore" column="storeOwner"/>
  		<association property="storeOwner" javaType="com.C2C.Entity.User" select="com.C2C.Mapper.UserMapper.getUserInfo" column="storeOwner"></association>
  	</association>
  </resultMap>
  
  <!-- int issueGood(@Param("idUser")int idUser, @Param("good")Good good); -->
  <insert id="issueGood">
  	INSERT INTO `c2cdemo`.`goods` 
  	(`category`, `sellStore`, `goodName`, `price`, `goodIntroduce`, `issueDate`) 
  	VALUES 
  	(#{good.category}, #{idStore}, #{good.goodName}, #{good.price}, #{good.goodIntroduce}, #{good.issueDate})
  </insert>
  
</mapper>